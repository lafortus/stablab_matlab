function [nhyp,nsys,A0,A1,Atilde,Einv,b_21,bj,bjk,A1_12_der,a,a_der] = A_aux_mhd_alpha(x,s,p)

% parameters
spd = p.spd;
a0 = p.a0;
nu = p.nu;
mu = p.mu;
eta = p.eta;
gam = p.gamma;
alpha = p.alpha;

% variables and derivatives
[rho,rho_x,u1,u1_x,u2,u2_x,h1,h1_x,h2,h2_x] = eval_prof_mhd_alpha(s,p,x);

% system sizes
nsys = 5;
nhyp = 1;

% A0
A0 = [
%
1, ... 
0, ... 
0, ... 
0, ... 
0, ... 
;
%
u1, ... 
rho, ... 
0, ... 
0, ... 
0, ... 
;
%
u2, ... 
0, ... 
rho, ... 
0, ... 
0, ... 
;
%
0, ... 
0, ... 
0, ... 
1, ... 
0, ... 
;
%
0, ... 
0, ... 
0, ... 
0, ... 
1, ... 
;
%
];


% A1
A1 = [
%
-spd + u1, ... 
rho, ... 
0, ... 
0, ... 
0, ... 
;
%
a0*gam*rho^gam/rho - spd*u1 + u1^2, ... 
-rho*spd + 2*rho*u1, ... 
0, ... 
-h1, ... 
h2, ... 
;
%
-spd*u2 + u1*u2, ... 
rho*u2, ... 
-rho*spd + rho*u1, ... 
-h2, ... 
-h1, ... 
;
%
0, ... 
0, ... 
0, ... 
alpha - spd, ... 
0, ... 
;
%
0, ... 
h2, ... 
-h1, ... 
-u2, ... 
-spd + u1, ... 
;
%
];



%b_{21}
b_21 = [
%
0, ... 
;
%
0, ... 
;
%
0, ... 
;
%
0, ... 
;
%
];



% E^{-1}
 Einv = [
%
1/(eta + 2*mu), ... 
0, ... 
0, ... 
0, ... 
;
%
0, ... 
1/mu, ... 
0, ... 
0, ... 
;
%
0, ... 
0, ... 
1/nu, ... 
0, ... 
;
%
0, ... 
0, ... 
0, ... 
1/nu, ... 
;
%
];



% (A^1_{12})_{x_1}
A1_12_der = [
%
rho_x, ... 
0, ... 
0, ... 
0, ... 
;
%
];



% a = (A^1_{11})^{-1}
 a = [
%
1/(-spd + u1), ... 
;
%
];



% a_{x_1}
a_der = [
%
-u1_x/(-spd + u1)^2, ... 
;
%
];



%bj
bj{1} = [
%
0, ... 
0, ... 
eta + mu, ... 
0, ... 
0, ... 
;
%
0, ... 
eta + mu, ... 
0, ... 
0, ... 
0, ... 
;
%
0, ... 
0, ... 
0, ... 
0, ... 
0, ... 
;
%
0, ... 
0, ... 
0, ... 
0, ... 
0, ... 
;
%
];



% Atilde
Atilde{1} = [
%
u2, ... 
0, ... 
rho, ... 
0, ... 
0, ... 
;
%
u1*u2, ... 
rho*u2, ... 
rho*u1, ... 
-h2, ... 
-h1, ... 
;
%
a0*gam*rho^gam/rho + u2^2, ... 
0, ... 
2*rho*u2, ... 
h1, ... 
-h2, ... 
;
%
0, ... 
-h2, ... 
h1, ... 
u2, ... 
alpha - u1, ... 
;
%
0, ... 
0, ... 
0, ... 
0, ... 
0, ... 
;
%
];



% bjk
bjk{1}{1} = [
%
0, ... 
mu, ... 
0, ... 
0, ... 
0, ... 
;
%
0, ... 
0, ... 
eta + 2*mu, ... 
0, ... 
0, ... 
;
%
0, ... 
0, ... 
0, ... 
nu, ... 
0, ... 
;
%
0, ... 
0, ... 
0, ... 
0, ... 
nu, ... 
;
%
];

